## Список изменений:

Language: Русский | [English](changelog_EN.md)

### v2.2.1

Добавлено:
- удаление одинарных и двойных кавычек при очистке hex-паттернов

Исправлено:
- предотвращена попытка удаления цифровой подписи у файлов, которых нет на диске из секции `patch_bin`

### v2.2

Добавлено:
- добавлены флаги шаблона `EXIT_IF_ANY_PATCH_BIN_FILE_NOT_EXIST` и `EXIT_IF_ANY_PATCH_TEXT_FILE_NOT_EXIST`

Исправлено:
- в скрипте-ядре: не создается бэкап файл, если паттерны поиска не были найдены
- в скрипте-ядре: исправлен алгоритм создания временного файла при поиске патч паттернов, теперь файл создается действительно уникальный (с уникальным именем) и не перезаписывает никакой существующий файл
- при обработке секции `patch_bin` теперь символы `?` заменяются `??` только в паттернах (при использовании флага `WILDCARD_IS_1_Q_SYMBOL`), а не в тексте всей секции
  - это предотвратит порчу путей в которых есть символ `?`

Улучшено:
- в ядре из hex-паттернов теперь удаляются еще и `,` и все виды отступов, а не только пробел

### v2.1

Добавлено:
- вывод информации об исходном количестве строк в файле hosts, количестве добавленных/удаленных строк и итоговом количестве строк в обновленном файле hosts
  - при работе секций `hosts_remove` и `hosts_add`

Исправлено:
- работа с атрибутом "Только чтение" для бэкап-файлов в "ядре"
- удалено создание бэкап-файлов при наличии флага `CHECK_OCCURRENCES_ONLY` или `CHECK_ALREADY_PATCHED_ONLY`, потому что эти флаги применяются только для подсчета, а не для изменения файлов
- удален текст в логе о том, что найденные паттерны были заменены, при использовании флага `PATCH_ONLY_ALL_PATTERNS_EXIST`, когда не все паттерны были найдены
- информация о найденных паттернах в секции `patch_text`
- комментарии для файла hosts в секциях `hosts_remove` и `hosts_add` считались комментариями шаблона и удалялись до начала обработки секции
- удалена замена всего текста `127.0.0.1` на `0.0.0.0` в файле hosts при любых действиях в секциях `hosts_remove` и `hosts_add`


### v2.0

Работа с байтами и hex-паттернами:
- Ядро переписано на C#
  - Теперь скорость поиска и замены байт многократно возросла, особенно для паттернов маленькой длины
  - C# код ядра находится внутри Powershell-скрипта в не скомпилированном виде и компилируется при запуске скрипта
  - код C# написан на C# v4.8, что позволяет ему нативно компилироваться в Windows 10 без установки чего-либо
  - C# код также содержит разные дополнительные функции, которые не задействованы в ReplaceHexBytesAll-патчере, но могут быть полезны тем, кто захочет осуществлять разные операции с байтами с помощью C# в других проектах
- Добавлена поддержка использования паттернов замены меньшей и большей длины, чем паттерны поиска
  - Паттерны замены не будут заменять паттерны поиска, а будут вставляться в позиции/оффсеты найденных мест паттернов поиска и с начала найденных позиций будут вставляться паттерны замены перезаписывая байты в позиции которых они вставляются
  - Это позволит писать более читабельные пары паттернов в тех ситуациях, когда нужно изменить байты только в начале найденных паттернов поиска
- Добавлен аргумент `-skipStopwatch` для отключения секундомера, если вам не интересна о скорости выполненной поиска и замены 
- Добавлен аргумент `-onlyCheckOccurrences` для проверки вхождения паттернов без их замены
  - То есть только для поиска паттернов-поиска и вывода информации о результатах поиска 
- Добавлены аргументы `-showMoreInfo`, `-showFoundOffsetsInDecimal`, `-showFoundOffsetsInHex` - для вывода более детальной информации о проделанных изменениях

Работа с шаблоном:
- Убрана поддержка в шаблоне нескольких секций для создания файлов - `file_create_from_text` и `file_create_from_base64`
  - Теперь парсер будет использовать только первую найденную секцию, а не все из них
  - Если необходимо создать/распаковать несколько файлов и они небольшого размера - можно их запаковать в zip-архив, а его положить как base64-код и обработать его и файлы из него с помощью powershell или cmd-кода. Или положить этот архив рядом с шаблоном и также обработать этот момент в секциях с кодом
- Убрал глобальную переменную `$USER` на `$env:USERNAME`
- Добавил глобальные переменные, поддержку замены текста `USERNAME_FIELD`, `USERPROFILE_FIELD` и `USERHOME_FIELD` на `$env:USERNAME` и `$env:USERPROFILE`
  - Чтобы в тексте с путями можно было использовать эти переменные, когда необходимо указать путь к файлам/папкам, находящихся внутри папки пользователя
- Добавил поддержку комментариев с `#`
- Добавил поддержку обработки шаблона, если он передается как base64-код
  - Это удобно, если шаблон нужно положить на каком-нибудь публичном сервере и хотя бы минимально скрыть то, что он делает. Если в качестве шаблона будет пиратская модификация/патч программы, то шаблон могут удалить, но base64-текст менее вероятно заподозрят
- Убрал поддержку флага `BINARY DATA` для секции создания файлов из base64-кода
  - base64-код расшифровывается в байты и из этих байт создается файл. Нет необходимости маркировать содержимое в зашифрованном base64-коде
- Добавил новые флаги: `REMOVE_SIGN_PATCHED_PE`, `CHECK_OCCURRENCES_ONLY`, `CHECK_ALREADY_PATCHED_ONLY`, `EXIT_IF_NO_ADMINS_RIGHTS`, `SHOW_EXECUTION_TIME`, `SHOW_SPACES_IN_LOGGED_PATTERNS`, `REMOVE_SPACES_IN_LOGGED_PATTERNS`, `PATCH_ONLY_ALL_PATTERNS_EXIST`

Другое:
- Добавил нативную утилиту для удаления цифровой подписи у PE-файлов (.exe, .dll и другие)
- Добавил поддержку проверки ссылки и скачивания по ней адресов для добавления в hosts
  - если в секции для добавления первая строка содержит текст `SEE_HERE_FIRST`, а потом ссылку на список и ссылка действительно есть и она доступна для скачивания, то в hosts добавляем содержимое скачанное по ссылке, а не остальные строки в секции добавления
- Исправлены разные баги
- Выполнена оптимизация некоторого кода
- Исправил скрипт-стартер `Start.cmd`


### v1.4

- Исправил некоторые баги
- Добавил поддержку подстановочных знаков `??` для поиска и замены hex-паттернов

### v1.3

- Исправил некоторые баги
- Добавил дополнительную папку для тестирования только алгоритмов/стратегий для поиска + замены байт и добавлены некоторые алгоритмы
- Нашел быстрый алгоритм для поиска + замены байт
- Заменил алгоритм в патчах и переработал его

### v1.2

- Исправил некоторые баги
- Извлек основные функции из отдельных Powershell-файлов и реализовал импорт их по условию

### v1.1

- Исправлена ситуация, когда паттерны не обнаруживались в патчере
- Исправлена ситуация, когда в патчере не было прав на чтение файла

### v1.0

- Первоначальный выпуск с полной рабочей версией