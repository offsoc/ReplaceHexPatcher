
##### ##### ##### ##### #####
THIS IS JUST EXAMPLE FILE
##### ##### ##### ##### #####

Template for Parser - https://github.com/Drovosek01/ReplaceHexPatcher/blob/main/wrappers/data%20in%20template/Parser.ps1

1. Lines containts 2 symbols semicolon (;;) or (#) - these lines is comment
    and these lines will be delete from full template before parse sections
2. All lines outside sections [start-*]/[end-*] - will not extract from template
    and will not affect the sections in any way.
    In fact, the text outside the sections can be considered comments
3. File has global variable `$USER` or `USERNAME_FIELD` and all these words will be replaced with current Windows username
4. File has global variable `USERPROFILE_FIELD` or `USERHOME_FIELD` and all these words will be replaced with current Windows user home path


Full documentation see here - https://github.com/Drovosek01/ReplaceHexPatcher/tree/main/docs


---

Possible flags:

MAKE_BACKUPS
REMOVE_SIGN_PATCHED_PE
CAN_USE_REGEXP_IN_PATCH_TEXT
PATCH_TEXT_IS_CASEINSENSITIVE
WILDCARD_IS_1_Q_SYMBOL
VERBOSE
CHECK_OCCURRENCES_ONLY
CHECK_ALREADY_PATCHED_ONLY
EXIT_IF_NO_ADMINS_RIGHTS
SHOW_EXECUTION_TIME
SHOW_SPACES_IN_LOGGED_PATTERNS
REMOVE_SPACES_IN_LOGGED_PATTERNS
PATCH_ONLY_ALL_BIN_PATTERNS_EXIST
PATCH_ONLY_ALL_BIN_PATTERNS_EXIST_1_TIME

[start-flags]
VERBOSE
PATCH_ONLY_ALL_BIN_PATTERNS_EXIST
MAKE_BACKUPS
[end-flags]

---


Write variables for current template-file
It will be separated on symbol `=` and first items before `=`
will search and replace in all sections in this file

[start-variables]
;; copied explorer.exe from C:\Windows
path_target_1 = C:\Users\$USER\AppData\Local\Temp\explorer.exe
;; copied regedit.exe from C:\Windows
path_target_2 = C:\Users\$USER\AppData\Local\Temp\regedit.exe
pattern_1 = 63 61 6E 6E 6F 74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53|63 61 6E 20 62 65 20 72 75 6E 6E 6E 69 6E 67 20 69 6E 20 44

original_1 = 63616E6E6F742062652072756E20696E20444F53
patched_1 = 63616E2062652072756E6E6E696E6720696E2044
pattern_2 = 53006F00660074007700610072006500|42006C006F0074007700610072006500
original_2 = 53006F00660074007700610072006500
patched_2 = 42006C006F0074007700610072006500
pattern_3 = 211AFEF2606F7E0D5AB5D2109E0623AA/909090F2606F7E0D5AB5D21090909090
pattern_4 = 40503C002849503C002F013C00020EC67C1200001918080018\405787802849AABB002F013909090EC1234200001918080018
[end-variables]

---


Write Powershell-code and will be created temp .ps1-file with this code and will be executed

[start-pre_powershell_code]
write-host "PRE POWERSHELL code"
$tempFile = [System.IO.Path]::GetTempFileName() + '.txt'
[void](New-Item -Path $tempFile -ItemType File -Force -ErrorAction Stop)
Add-Content -Path $tempFile -Value "test`ntext"
write-host 'DONE'
write-host 'file is' $tempFile
Remove-Item -Path $tempFile -Force
[end-pre_powershell_code]

---


Write CMD-code and will be created temp .cmd-file with this code and will be executed

[start-pre_cmd_code]
@echo off
echo PRE CMD CODE
set "testtext=Some text for echo"
set "filepath=C:\Users\%USERNAME%\AppData\Local\Temp\testfile.txt"
echo %testtext% > %filepath%
echo "GOOOOOOOOOOT IT теперь удалить"
del %filepath%
[end-pre_cmd_code]

---


Write paths to files then hex-patterns for find+replace bytes
After line with path to file all other lines below will be considered strings with patterns
String with pattern can contain full pattern search and replace with separator symbol
or search and replace patterns on different lines

[start-patch_bin]
path_target_1
pattern_1
original_2
patched_2
pattern_3
pattern_4
;; other file
path_target_2
original_1
patched_1
[end-patch_bin]

---


Write lines for search for delete from hosts-file
If line start with comment symbol # or start with 127.0.0.1 or start with 0.0.0.0
Line will search without modifications (but spaces will be adaptive for search)
Otherwise it mean line contain URL-word for search in hosts lines for delete line with this word
We can use star symbol * and it will be replaced with `.*` and used like regex within the boundaries of the word

[start-hosts_remove]
# Just some title
0.0.0.0                  anysute.com
site.com*
sdjfhksdf.com
ij.sddddwr.ru
bdj.sdfsdf.ss
*adobe.io*
[end-hosts_remove]

---


Write lines for add to hosts-file.
If line start with comment symbol # or start with 127.0.0.1 or start with 0.0.0.0
Line will add to hosts without modifications
Otherwise it mean line contain URL for block and before URL-address
will be added `0.0.0.0 `

[start-hosts_add]
# Just some title
anysute.com
sdjfhksdf.com
ij.sddddwr.ru
bdj.sdfsdf.ss
[end-hosts_add]

---


Write absolute paths to files and folders for delete it
If first line contain text `MOVE TO BIN` it mean all files or folders will move to bin
otherwise it will be deleted from system

[start-files_or_folders_delete]
MOVE TO BIN
C:\Users\$USER\AppData\Local\Temp\TestFolder123
C:\Users\$USER\AppData\Local\Temp\TestFile456
[end-files_or_folders_delete]

---


Write data for create text-file
First line always is absolute path to file
Second line can be "flag" with type of end of lines - CRLF or LF
Other lines - content for created file.
Empty lines will not deleted.
There may be several such sections.

[start-file_create_from_text]
C:\Users\$USER\AppData\Local\Temp\license file.lic
LF
LICENSE company product1 2099.99 permanent uncounted hostid=ANY
  issued=1-oct-2023 _ck=bc1e94b45e sig="60P0450BS5WA0G7VJPP96BBAAKB36J
  B97TSF8MG22GD0ABHFK09Q0WPNFF1543YXM0RSYN6JD4"
LICENSE company product2 2099.99 permanent uncounted hostid=ANY
  issued=1-oct-2023 _ck=c51e947507 sig="60P0451JSHX4N85D89MA8R0D8UFTNE
  NCAHCS5K822HNR6ACG1VVK6T6UXVQ9C894YY2MFGTBEC"
LICENSE company product3 2099.99 permanent uncounted hostid=ANY
  issued=1-oct-2023 _ck=321e9478d7 sig="60PG4580G7JA027QRQ9HEV39P7553R
  GBS7FK6R5M08A0QJ59X2V3VEER4TA348065RQ967481KFG"





[end-file_create_from_text]

---


Write data for create file with content from decoded base64-code
First line always is absolute path to file
Second line can be "flag" with type of content inside base64 - `BINARY DATA`.
If section have this flag decoded data will be represented as bytes and written to a file. Otherwise decoded data is text.
Also second line can have flag of type of end of lines - CRLF or LF.
If decoded data not binary - end of lines these text will be converted to this type of end of lines.
Other lines - content of big base64-code.
Empty lines will not deleted.
There may be several such sections.

[start-file_create_from_base64]
C:\Users\$USER\AppData\Local\Temp\file created from base64.txt
TElDRU5TRSBmb3VuZHJ5IG1vZG9faSAyMDk5Ljk5IHBlcm1hb
mVudCB1bmNvdW50ZWQgaG9zdGlkPUFOWQ0KICBpc3N1ZWQ9MS1vY3QtMjAyMyBfY2s9
YmMxZTk0YjQ1ZSBzaWc9IjYwUDA0NTBCUzVXQTBHN1ZKUFA5NkJCQUFLQjM2Sg0KICBCOTdUU0Y4TUcyMkdEMEFCSEZLMD
lRMFdQTkZGMTU0M1lYTTBSU1lONkpENCINCkxJQ0VOU0UgZm91bmRyeSBtb2RvX3IgMjA5OS45OSBwZXJtYW5lbnQgdW5jb3VudGVkIGhvc3RpZD1BTlkNCiAgaXNzdWVkPTEtb2N0L
TIwMjMgX2NrPWM1MWU5NDc1MDcgc2lnPSI2MFAwNDUxSlNIWDROODVEODlNQThSMEQ4VUZUTkUNCiAgTkNBSENTNUs4MjJITlI2QUNHMVZWSzZUNlVYVlE5Qzg5NFlZMk1GR1RCRUMiDQpMSUNFTlNFIGZvdW5kcnkgbW9kb3ZfaSAyMDk5Ljk5IHBlcm1hbmVudCB1bmNvdW50ZWQgaG9zdGlkPUFOWQ0KICBpc3N1ZWQ9MS1vY3QtMjAyMyBfY2s9MzIxZTk0NzhkNyBzaWc9IjYwUEc0NTgwRzdKQTAyN1FSUTlIRVYzOVA3NTUzUg0KICBHQlM3Rks2UjVNMDhBMFFKNTlYMlYzVkVFUjRUQTM0ODA2NVJROTY3NDgxS0ZHIg0KDQoNCg0KDQoNCg==
[end-file_create_from_base64]

---


Write lines with absolute paths for .exe-files
and all rules with these exe-files will be deleted from Windows Firewall

[start-firewall_remove_block]
path_target_1
path_target_2
C:\Users\$USER\AppData\Local\Temp\Test Folder\*.exe
C:\Users\$USER\AppData\Local\Temp\Test Folder with subfolders\*

[end-firewall_remove_block]

---


Write lines with absolute paths for .exe-files
and for all these exe-files will be added rules in Windows Firewall for block all connections
Also we can write path for folder with end path like `\*` it mean block all exe-files in this folder and all subfolders
but if it ends like `\*.exe` it mean block all exe-files only in this folder

[start-firewall_block]
path_target_1
path_target_2
C:\Users\$USER\AppData\Local\Temp\Test Folder\*.exe
C:\Users\$USER\AppData\Local\Temp\Test Folder with subfolders\*
[end-firewall_block]

---


Write same lines like in .reg-file and it will be executed/applied to Windows Registry
First line section can skip text Windows Registry Editor Version 5.00
and Parser will add it dynamically

[start-registry_file]

;
; Этот файл должен быть в кодировке UTF-16 LE с BOM, чтобы слова на кириллице в контекстном меню не отображались кракозябрами
;

;
;
; Настройка Проводника
;
;

; Включить отображение расширений файлов
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
"HideFileExt"=dword:00000000

;Выключение сохранения списков открывавшихся файлов
;В проводнике это делается через параметры и снятие 1 галки в разделе Конфиденциальность
;Показать недавно использовавшиеся файлы на панели быстрого доступа
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer]
"NoRecentDocsHistory"=dword:00000001
[end-registry_file]

---


Write Powershell-code and will be created temp .ps1-file with this code and will be executed

[start-post_powershell_code]
write-host "POST POWERSHELL code"
$tempFile = [System.IO.Path]::GetTempFileName() + '.txt'
[void](New-Item -Path $tempFile -ItemType File -Force -ErrorAction Stop)
Add-Content -Path $tempFile -Value "test`ntext"
write-host 'DONE'
write-host 'file is' $tempFile
Remove-Item -Path $tempFile -Force
[end-post_powershell_code]

---


Write CMD-code and will be created temp .cmd-file with this code and will be executed

[start-post_cmd_code]
@echo off
echo POST CMD CODE
set "testtext=Some text for echo"
set "filepath=C:\Users\%USERNAME%\AppData\Local\Temp\testfile.txt"
echo %testtext% > %filepath%
echo "GOOOOOOOOOOT IT теперь удалить"
pause
del %filepath%
[end-post_cmd_code]





